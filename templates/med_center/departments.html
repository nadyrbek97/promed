{% extends 'med_center/index.html' %}
{% load static %}

{% block title %}
    Отделения
{% endblock %}

{% block content %}
  <section class="probootstrap-services">
    <div class="container">
      <div class="row no-gutters">
        <div class="col-md-3 pb-5 probootstrap-aside-stretch-left probootstrap-inside">
          <div class="mb-3 pt-5">
            <h2 class="h6">Отделения</h2>
            <ul class="list-unstyled probootstrap-light mb-4">
                {% for department in departments %}
                    <li><a href="#">{{ department.title }}</a></li>
                {% endfor %}
            </ul>
          </div>
        </div>
        <div class="col-md-9 pl-md-5 pb-5 pl-0 probootstrap-inside">
          <h1 class="mt-4 mb-4">УЗИ</h1>
          <p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean.</p>

          <p>A small river named Duden flows by their place and supplies it with the necessary regelialia. It is a paradisematic country, in which roasted parts of sentences fly into your mouth.</p><p>But nothing the copy said could convince her and so it didn’t take long until a few insidious Copy Writers ambushed her, made her drunk with Longe and Parole and dragged her into their agency, where they abused her for their.</p>
        </div>
      </div>
    </div>
  </section>
    <script>
    $('.get-service').click(function (event) {
        var dep_id = $('span', this).attr('id');
        var service_section = $('#service-section')

         $.ajax({
                url: '/api/services/list/' + dep_id + '/',
                method: 'GET',
                data: ({
                    'department_id': dep_id
                }),
                dataType: 'json',
                contentType: 'application/json',
                success: function (data) {
                    service_section.html('')
                    data.services.forEach(
                        service => service_section.append(
                            render_service_section(service.title, service.price)
                        )
                    )
                },
                error: function (request, error) {
                    console.log(request);
                    console.log(error);
                }
            });
        console.log(dep_id);
        console.log("clicked");
    })

    function render_service_section(service_title, service_price) {
        html_item = '<div class="col-lg-4 col-md-6">\n' +
            '                    <div class="media d-block mb-4 text-left probootstrap-media">\n' +
            '                        <div class="probootstrap-icon mb-3"><span class="flaticon-microscope display-4"></span></div>\n' +
            '                          <div class="media-body">\n' +
            '                            <h3 class="h5 mt-0 text-secondary">' + service_title + '</h3>\n' +
            '                            <p> ' + service_price + ' сом </p>\n' +
            '                          </div>\n' +
            '                    </div>\n' +
            '                  </div>'
        return html_item
    }
</script>

{% endblock %}